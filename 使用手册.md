# Relio（对话回复决策系统）使用手册

> 适用对象：软件著作权材料中的“使用手册/操作说明书”。
>
> 说明：本文档中的“截图占位”请在最终提交前替换为实际界面截图（建议按占位提示的页面与步骤顺序截图）。

---

## 第一章 项目名称及背景

### 1.1 项目名称
- 中文名称：对话回复决策系统
- 英文名称：Relio（Relationship Intelligence Orchestrator）
- 软件定位：智能关系管理与对话回复决策辅助软件（非自动聊天机器人）

### 1.2 项目背景
在日常社交沟通中，同一句话面对不同对象、不同关系阶段往往需要不同的表达方式。Relio 通过“用户画像 + 关系状态 + 对话分析”三类信息，辅助用户更稳定地做出合适的回复决策，降低沟通成本与关系风险。

### 1.3 版本信息
- 软件版本：V1.0.0
- 运行平台：macOS（支持以源码方式在 Windows/Linux 运行）
- 开发语言：Python 3.10+（桌面端 GUI 基于 PySide6）

### 1.4 编制信息（请按软著材料补全）
- 著作权人/开发单位：________
- 软件作者/开发人员：________
- 开发完成日期：________
- 首次发表日期（如有）：________
- 联系方式（如需）：________

### 1.5 术语与约定
- “关系对象”：在系统中被管理的联系人/对话对象。
- “亲密度”：用于量化关系状态的分值（0%~100%），随互动与反馈动态变化。
- “关系画像”：以基本信息、亲密度趋势、风险提示、风格滑块等形式展示的对象综合画像。
- “长期记忆”：对关系对象长期有效的信息沉淀，分为：对象特征、关系事件、沟通策略。
- “回复建议”：系统基于对象画像、关系状态、对话内容生成的可选回复文本。

---

## 第二章 项目介绍

### 2.1 项目目标
- 为每位关系对象建立可维护、可演化的画像信息。
- 动态追踪关系状态（亲密度、关系阶段、交互趋势、风险提示）。
- 对输入消息进行语境分析，生成多方案的个性化回复建议。
- 通过用户反馈（喜欢/不喜欢）与长期记忆提取，持续优化建议质量。

### 2.2 功能组成
1. 关系管理
- 添加/编辑/删除/置顶关系对象
- 对象搜索（姓名/标签）
- 数据导入/导出（JSON）

2. 回复建议（对话决策辅助）
- 输入消息并生成回复建议
- 复选“策略倾向”（更亲近/更正式/保持距离/幽默回应）以影响回复风格
- 对生成回复进行复制与反馈（👍/👎）

3. 关系画像
- 展示对象基本信息与关系目标
- 显示亲密度与关系阶段、趋势折线图
- 风格画像滑块（正式程度/情感温度/直接程度/幽默接受度）支持人工微调
- 关系演化备注（人工记录）

4. 长期记忆
- 记忆分类：对象特征 / 关系事件 / 沟通策略
- 手工新增、编辑、删除
- AI 自动提取：从对话记录中提取长期记忆（并支持去重/合并）
- 记忆摘要：统计条目数量，提炼可用于回复的高置信度信息

5. 配置与优化
- 模型 API 配置（Key/URL/模型名及生成参数）
- 亲密度权重设置（衰减、增长、初始亲密度）
- 主题切换（浅色/深色/跟随系统）
- 帮助：使用说明、算法说明

### 2.3 运行与数据存储说明
- 模型调用：通过 OpenAI 兼容接口调用第三方大语言模型服务（例如 SiliconFlow 兼容接口）。
- 数据落盘位置：
  - macOS 打包应用运行：`~/Library/Application Support/Relio/`
  - 源码运行（开发模式）：项目目录下的 `data/`
- 主要数据文件（示例）：
  - `profiles.json`：对象画像/风格等信息
  - `relationship_states.json`：关系状态信息
  - `user_settings.json`：用户设置（包含 API 配置、主题、亲密度权重等）
  - 以及长期记忆相关数据（由 UI 侧记忆服务维护）

### 2.4 隐私与安全建议
- API Key 属于敏感信息，请勿在截图、文档或公开仓库中泄露；截图时建议对 Key 字段打码。
- Relio 为“决策辅助工具”，不自动向外部平台发送消息；用户需自行复制建议并发送。

---

## 第三章 软件使用

> 本章按“从零到可用”的顺序编写。若用于软著材料，建议截图按本章顺序编号。

### 3.1 安装与启动

#### 3.1.1 方式一：运行 macOS 应用（推荐）
1. 获取 `Relio.app`（预构建应用）。
2. 将 `Relio.app` 拖拽到“应用程序”目录。
3. 双击启动应用。

- 【截图占位】图 3-1：macOS “应用程序”中显示 Relio.app 的位置
- 【截图占位】图 3-2：Relio 启动后的主界面

#### 3.1.2 方式二：从源码运行（开发/测试）
1. 准备 Python 3.10 或更高版本。
2. 在项目根目录安装依赖：
   - 执行 `pip install -r requirements.txt` 或使用 conda 环境安装。
3. 启动：运行 `python main.py`。

- 【截图占位】图 3-3：终端运行 `python main.py` 的启动示例（可选）

> 说明：源码运行时，数据默认保存在项目目录的 `data/` 下；打包应用则写入用户目录的 Application Support。

---

### 3.2 首次使用：模型 API 配置

> 若未正确配置 API，回复建议与 AI 提取功能可能无法正常工作。

1. 启动软件后，在顶部菜单栏选择：**设置 → 模型 API 配置**。
2. 在弹窗中填写：
   - **API Key**：填写你的模型服务密钥（建议粘贴后检查首尾空格）。
   - **API 基础 URL**：模型服务的兼容接口地址。
   - **模型名称**：目标模型标识。
   - 生成参数：Temperature、Top P、Frequency Penalty、最大 Token 数、对话上下文轮数。
3. 点击“测试连接”：若提示连接成功，说明配置可用。
4. 点击“保存”：配置将立即生效，并写入用户设置文件，重启后仍有效。

- 【截图占位】图 3-4：设置菜单展开（包含“模型 API 配置”）
- 【截图占位】图 3-5：模型 API 配置对话框（Key 请打码）
- 【截图占位】图 3-6：测试连接成功提示弹窗

---

### 3.3 关系对象管理（新增/编辑/删除/置顶）

#### 3.3.1 新增关系对象
1. 在主界面左侧，点击“添加对象”。
2. 在“添加关系对象”对话框中填写（建议至少完成必填项）：
   - 基本信息：姓名/备注名、关系类型、身份相对关系、年龄层
   - 关系目标（多选）：维持关系/拉近关系/保持距离/提升专业感
   - 初始性格标签：用逗号分隔，例如“不喜欢废话, 情绪稳定, 注重逻辑”
   - 补充说明：可填写该对象的特殊偏好或沟通注意事项
3. 点击“确定”保存。

- 【截图占位】图 3-7：主界面左侧“添加对象”按钮位置
- 【截图占位】图 3-8：添加关系对象对话框（填写示例）
- 【截图占位】图 3-9：新增对象后出现在左侧对象列表

#### 3.3.2 搜索对象
1. 在左侧搜索框输入关键词（支持姓名/标签）。
2. 列表将实时过滤匹配对象。

- 【截图占位】图 3-10：搜索框输入关键字后的过滤效果

#### 3.3.3 编辑/删除/置顶对象
1. 在左侧对象列表中，对目标对象点击右键，弹出菜单。
2. 根据需要选择：
   - “编辑对象”：修改基本信息、关系目标、标签、备注等。
   - “删除对象”：删除该对象及其相关数据（不可撤销）。
   - “置顶对象”：将对象移动到列表顶部，便于常用对象快速访问。

- 【截图占位】图 3-11：对象右键菜单（编辑/删除/置顶）

---

### 3.4 回复建议（对话决策辅助）

> “回复建议”模块用于输入对方发来的消息，系统返回多条建议回复。用户可复制后自行发送。

#### 3.4.1 进入回复建议模块
1. 在右侧顶部标题栏，点击“⋯”菜单。
2. 选择“回复建议”。

- 【截图占位】图 3-12：右侧模块菜单（回复建议/关系画像/长期记忆）

#### 3.4.2 生成回复建议（一步步）
1. 在左侧选择一个关系对象。
2. 在“回复策略选择”区域勾选策略倾向（可不选）：
   - 更亲近：引导更亲近的语气与措辞
   - 更正式：更偏书面、礼貌、结构化表达
   - 保持距离：更克制、更边界感的表述
   - 幽默回应：适度加入轻松/幽默元素
3. 在输入框中粘贴或输入“收到的消息内容”。
   - 回车：发送
   - Shift + 回车：换行
4. 点击“发送”（或回车）后，系统显示：
   - 你的输入消息气泡
   - “生成中”等待提示
   - 生成完成后出现 1~3 条建议回复（以气泡形式展示）

- 【截图占位】图 3-13：选择对象后的回复建议界面
- 【截图占位】图 3-14：勾选策略倾向示例（更亲近/更正式等）
- 【截图占位】图 3-15：输入消息并点击发送
- 【截图占位】图 3-16：等待提示（生成中）
- 【截图占位】图 3-17：生成完成后的多条建议回复

#### 3.4.3 复制建议回复
1. 在任意一条建议回复气泡下，点击“📋 复制”按钮。
2. 提示“已复制”后，即可粘贴到实际聊天工具中发送。

- 【截图占位】图 3-18：建议回复气泡下方的复制按钮位置

#### 3.4.4 对建议进行反馈（👍/👎）
> 反馈用于影响对象亲密度与系统偏好学习：
> - 👍：表示喜欢该回复（通常会提升亲密度与接受率）
> - 👎：表示不喜欢该回复（通常会降低亲密度或降低接受率）

1. 在建议回复气泡下方点击“👍”或“👎”。
2. 同一轮次（同一批建议回复）内，系统会对喜欢/不喜欢进行去重处理，避免重复计数。
3. 反馈完成后，可切换到“关系画像”查看亲密度与趋势变化。

- 【截图占位】图 3-19：点赞/点踩按钮位置（同一条回复下方）
- 【截图占位】图 3-20：反馈后亲密度变化（在关系画像中体现）

---

### 3.5 关系画像（查看关系状态与微调风格）

#### 3.5.1 进入关系画像模块
1. 在右侧顶部“⋯”菜单选择“关系画像”。

- 【截图占位】图 3-21：切换到关系画像页面

#### 3.5.2 查看亲密度与趋势
在“关系阶段 & 亲密度”“关系变化趋势”等区域可查看：
- 当前关系阶段与亲密度百分比
- 亲密度变化趋势折线图
- 风险提示（例如“长期未交互”“亲密度持续下降”等）

- 【截图占位】图 3-22：亲密度与关系阶段展示
- 【截图占位】图 3-23：亲密度趋势折线图
- 【截图占位】图 3-24：关系风险提示区域

#### 3.5.3 微调对话风格画像
1. 在“对话风格画像（可手动微调）”区域调整滑块：
   - 正式程度
   - 情感温度
   - 直接程度
   - 幽默接受度
2. 调整后将即时保存，并用于后续回复建议生成。

- 【截图占位】图 3-25：风格滑块区域（调整前后对比可选）

#### 3.5.4 记录关系演化备注（人工）
1. 在“关系演化备注（人工）”输入框中填写备注，如“最近对方压力大”。
2. 点击“记录备注”保存，备注列表会显示最新内容。

- 【截图占位】图 3-26：记录关系演化备注的输入框与按钮

---

### 3.6 长期记忆（沉淀信息、AI 提取与去重）

#### 3.6.1 进入长期记忆模块
1. 在右侧顶部“⋯”菜单选择“长期记忆”。
2. 页面顶部提供三个标签页：
   - 对象特征
   - 关系事件
   - 沟通策略

- 【截图占位】图 3-27：长期记忆页面与三个标签页

#### 3.6.2 手动新增记忆
1. 选择需要新增的记忆类型标签页（对象特征/关系事件/沟通策略）。
2. 点击“新增”。
3. 在弹窗中填写内容并点击“确定”。

说明：
- 对象特征：支持填写“置信度”（0~1）。
- 关系事件：支持填写事件影响（-1~+1）与发生时间。
- 沟通策略：支持填写策略有效性（0~1）。

- 【截图占位】图 3-28：点击“新增”按钮
- 【截图占位】图 3-29：新增对象特征弹窗
- 【截图占位】图 3-30：新增关系事件弹窗
- 【截图占位】图 3-31：新增沟通策略弹窗

#### 3.6.3 编辑/删除记忆条目
1. 在记忆卡片右侧点击“✏️”编辑或“🗑️”删除。
2. 删除会二次确认，确认后不可恢复。

- 【截图占位】图 3-32：记忆卡片的编辑/删除按钮

#### 3.6.4 AI 自动提取记忆（推荐流程）
> AI 提取依赖：该对象至少存在一些对话记录（来自“回复建议”模块）。

1. 在“长期记忆”页面点击“AI 提取”。
2. 系统会从当前对象的对话记录中提取：对象特征、关系事件、沟通策略。
3. 在提取结果对话框中勾选要保存的条目并确认。
4. 系统会进行去重/融合：
   - 对象特征、关系事件：对比已有内容，若相似会提示“替换/保留”。
   - 沟通策略：若策略模式相同，会提示“融合”（加权更新有效性与验证次数）。
5. 完成后弹出“提取完成”提示。

- 【截图占位】图 3-33：点击“AI 提取”按钮
- 【截图占位】图 3-34：AI 提取进行中的对话框
- 【截图占位】图 3-35：提取结果勾选保存的界面
- 【截图占位】图 3-36：相似内容去重/替换提示弹窗
- 【截图占位】图 3-37：策略融合提示弹窗
- 【截图占位】图 3-38：提取完成提示弹窗

#### 3.6.5 记忆摘要
1. 在“长期记忆”页面点击“记忆摘要”。
2. 系统将展示：
   - 记忆统计（各类条目数量）
   - 高置信度对象特征（用于回复）
   - 有效策略与应避免策略（如数据足够）

- 【截图占位】图 3-39：点击“记忆摘要”按钮
- 【截图占位】图 3-40：记忆摘要弹窗

---

### 3.7 数据导入/导出（备份与迁移）

#### 3.7.1 导出关系数据
1. 菜单栏选择：**文件 → 导出关系数据**。
2. 选择保存路径并确认。
3. 系统生成一个 JSON 文件，用于备份与迁移。

- 【截图占位】图 3-41：文件菜单中的“导出关系数据”
- 【截图占位】图 3-42：导出文件保存对话框

#### 3.7.2 导入关系数据
1. 菜单栏选择：**文件 → 导入关系数据**。
2. 选择之前导出的 JSON 文件。
3. 导入完成后，左侧对象列表将刷新显示。

- 【截图占位】图 3-43：文件菜单中的“导入关系数据”
- 【截图占位】图 3-44：导入文件选择对话框

> 注意：导入会覆盖当前内存中的对象与记忆数据，请先导出备份。

---

### 3.8 主题切换与帮助

#### 3.8.1 主题切换
1. 菜单栏选择：**设置 → 主题**。
2. 选择：浅色 / 深色 / 跟随系统。

- 【截图占位】图 3-45：主题切换菜单

#### 3.8.2 查看使用说明与算法说明
1. 菜单栏选择：**帮助 → 使用说明**，可查看功能概览。
2. 菜单栏选择：**帮助 → 算法说明**，可查看亲密度、记忆去重与回复生成策略的说明。

- 【截图占位】图 3-46：帮助菜单
- 【截图占位】图 3-47：使用说明对话框
- 【截图占位】图 3-48：算法说明对话框

---

### 3.9 常见问题与注意事项

1. 无法生成回复或 AI 提取无结果
- 检查是否已配置可用的 API Key 与 Base URL（设置 → 模型 API 配置 → 测试连接）。
- 检查网络连接是否可访问模型服务。
- AI 提取需要当前对象存在对话记录；请先在“回复建议”模块完成至少一轮对话。

2. 亲密度没有变化
- 亲密度变化与反馈（👍/👎）、交互频率、衰减机制有关；可在“关系画像”查看趋势。
- 同一轮次的反馈会去重处理，避免重复计数。

3. 数据备份与迁移建议
- 定期使用“文件 → 导出关系数据”备份。
- 更换电脑或重装系统后，可使用“导入关系数据”恢复。

4. 信息安全建议
- 截图或录屏时，API Key 字段请打码。
- 不建议在公共环境展示包含私密对话内容的页面截图。
